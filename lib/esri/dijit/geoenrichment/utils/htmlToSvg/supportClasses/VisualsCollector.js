// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.22/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/utils/htmlToSvg/supportClasses/VisualsCollector",["dojo/_base/Color","dojo/dom-style","./TextMeasurer","./TransformUtil","./VisibilityChecker"],function(m,b,u,v,w){var x={SPAN:1,A:1,B:1,I:1,U:1,FONT:1},y={_MAP:{"font-weight":"fontWeight","font-style":"fontStyle","white-space":"whiteSpace","word-wrap":"wordWrap","word-break":"wordBreak","overflow-wrap":"overflowWrap","text-decoration":"textDecoration"},buildTextStyle:function(a,d,f,g){var c="",e;for(e in this._MAP){var h=
b.get(a,this._MAP[e]);h&&(c+=e+":"+h+";")}(a=b.get(a,"fontFamily").replace(/"/g,"'"))&&(c+="font-family:"+a+";");d&&(c+="font-size:"+d+"px;");f&&(c+="text-align:"+f+";");g&&"normal"!=g&&(c+="line-height:"+g+"px;");return c}};return{getNodeVisuals:function(a,d){function f(c,d){var e=new m(b.get(a,"border"+d+"Color"));n[c]={color:e.toHex(),opacity:e.a*g,width:b.get(a,"border"+d+"Width"),style:b.get(a,"border"+d+"Style")}}if(!w.checkNode(a))return null;var g=d?d.style.opacity:1,c=d&&d.isLink,e=b.get(a,
"width"),h=b.get(a,"height"),k={l:b.get(a,"paddingLeft"),r:b.get(a,"paddingRight"),t:b.get(a,"paddingTop"),b:b.get(a,"paddingBottom")},z=e+k.l+k.r,A=h+k.t+k.b,l=new m(b.get(a,"backgroundColor")),B={color:l.toHex(),opacity:l.a*g,image:b.get(a,"backgroundImage"),size:b.get(a,"backgroundSize"),positionX:b.get(a,"backgroundPositionX"),positionY:b.get(a,"backgroundPositionY")},n={};f("l","Left");f("r","Right");f("t","Top");f("b","Bottom");var p=b.toPixelValue(a,b.get(a,"fontSize")),q=b.get(a,"textAlign"),
C=b.get(a,"lineHeight"),r=v.measureNode(a),t=b.get(a,"position"),l=x[a.nodeName],c={box:r.box,style:{cw:e,ch:h,pw:z,ph:A,paddings:k,border:n,borderRadius:b.toPixelValue(a,b.get(a,"borderBottomLeftRadius")),background:B,color:(new m(b.get(a,"color"))).toHex(),fontSize:p,textAlign:q,getTextStyle:function(c,d){if(c)return b.get(a,c);var e=y.buildTextStyle(a,p,q,C);if(d)for(var f in d)e=e.replace(new RegExp("(^|;)"+f+":.*?(;|$)"),"$1"+f+":"+d[f]+"$2");return e},opacity:b.get(a,"opacity")*g,overflow:b.get(a,
"overflow"),spanFlowStartOffset:0,spanFlowEndOffset:0,display:b.get(a,"display"),isMiddle:"middle"==b.get(a,"verticalAlign"),transform:r.transform,isRelAbs:"relative"==t||"absolute"==t},isSpanLike:l,isLink:"A"===a.nodeName||c};l&&(e=u.getSpanFlowOffsets(a,c),c.style.spanFlowStartOffset=e.start,c.style.spanFlowEndOffset=e.end);c.isLink&&(c.href=a.href||d.href,c.target=a.target||d.target);return c}}});