// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.22/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/dataProviders/commands/CreatePlayerCommand","dojo/_base/declare dojo/promise/all dojo/when dijit/Dialog ./createHTML/HTMLStringBuilder esri/dijit/geoenrichment/utils/FileUtil ./supportClasses/MapToImageUtil ./supportClasses/PlayerCommands ../supportClasses/GEUtil ./_config dojo/i18n!../../../../../nls/jsapi".split(" "),function(h,w,g,p,q,r,t,u,v,b,e){e=e.geoenrichment.dijit.ReportPlayer.ReportPlayer;return h(null,{id:u.DYNAMIC_HTML,errorMessage:e.createHTMLError,
execute:function(f,d){function e(a,c,b){return a&&k._confirmSaveFile(c,function(){r.saveTextFile(a,c,b)})}function h(a){a=JSON.stringify(a);var c=[];c.push('html, body, #layoutNode { padding: 0px; margin: 0px; height: 100%; overflow: hidden; font-size: 13px; background-color: #525659; font-family: "Avenir Next"; }');a=q.composeHtmlStringFromParts({reportTitle:l,links:[b.esriDijitCssUrl,b.playerSourceRootUrl+b.playerCssUrl],cssFiles:c,scripts:[{src:b.playerSourceRootUrl+b.playerConfigUrl},{"data-dojo-config":"baseUrl: '"+
b.playerSourceRootUrl+"', isDebug: 1, waitSeconds: 60",src:b.playerSourceRootUrl+b.playerMainUrl},'require(["dojo/when","esri/dijit/geoenrichment/ReportPlayer/ReportPlayer","esri/dijit/geoenrichment/ReportPlayer/dataProviders/DataProviderGE","esri/dijit/geoenrichment/ReportPlayer/PlayerResizeModes","esri/dijit/geoenrichment/ReportPlayer/PlayerZoomBehaviors","esri/dijit/geoenrichment/ReportPlayer/dataProviders/commands/supportClasses/PlayerCommands","esri/dijit/geoenrichment/utils/UrlUtil","dojo/domReady!"],function (when,ReportPlayer,DataProviderGE,PlayerResizeModes,PlayerZoomBehaviors,PlayerCommands,UrlUtil) {esriConfig.defaults.io.proxyUrl \x3d UrlUtil.getVariableValue(window.location.href, "proxy") || null;var reportDataJson \x3d '+
a+';var dataProvider \x3d new DataProviderGE();dataProvider.registerCommand(PlayerCommands.HTML, "HTML");dataProvider.registerCommand(PlayerCommands.PRINT, "Print");var player \x3d new ReportPlayer({isSlidesView: UrlUtil.getVariableValue(window.location.href, "slidesView"),dataProvider: dataProvider,resizeMode: PlayerResizeModes.FIT_WINDOW,defaultZoomBehavior: PlayerZoomBehaviors.FIT_PAGE}).placeAt(layoutNode);when(dataProvider.reportDataFromJson(reportDataJson), function (reportData) {player.setReportData(reportData);});});'],
contentString:'\x3cdiv id\x3d"layoutNode"\x3e\x3c/div\x3e'});c=l+".html";m.htmlString=a;return e(a,c,"text/html")}var k=this,n=d&&d.printableContainer,m={htmlString:null},l=f.getReportTitle();return g(t.collectMapsAsImages(f,{saveImagesAsBase64:!0}),function(a){return g(f.dataProvider.reportDataToJson(f.getReportData(),{mapImageInfos:a}),function(a){return g(h(a),function(){d.creditsTaskID&&v.consumeCredits(f.getReportData().config.geoenrichmentUrl,d.creditsTaskID)})})},function(a){k._handleError(a)}).always(function(){return g(n&&
n.stop(),function(){return m})})},_handleError:function(b){console.log(b);(new p({title:"Error",content:this.errorMessage})).show()},_confirmSaveFile:function(b,d){return d()}})});