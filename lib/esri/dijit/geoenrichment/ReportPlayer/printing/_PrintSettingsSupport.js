// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.22/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/printing/_PrintSettingsSupport","dojo/_base/declare dojo/Deferred dojo/when esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DocumentOptions esri/dijit/geoenrichment/ReportPlayer/dataProviders/commands/supportClasses/PlayerCommands esri/dijit/geoenrichment/utils/DateUtil".split(" "),function(l,k,f,m,h,n){return l(null,{_checkPrintSettings:function(a){function c(){var g={needAutoScale:!1,addHeader:!1,addDataSource:!1,addFooter:!1,pageSettings:b._getReportContainer().documentOptions,
commandId:a.commandId};f(b.__applyPrintSettings(g),d.resolve,d.reject)}function e(){f(b._player.dataProvider.getCommands(),function(g){g={needAutoScale:a.commandId!==h.DYNAMIC_HTML&&b._getReportContainer().hasHiddenContent(),showLayoutOptions:!0,currentPageSettings:b._getReportContainer().documentOptions,commandId:a.commandId,canAddHeaderAndFooter:!0,exportCommands:a.commandId==h.PRINT?null:g.filter(function(b){return b.id!=h.PRINT})};var c=new b._player.printConfig.printDialogClass;c.onPrint=function(a){f(b.__applyPrintSettings(a),
d.resolve,d.reject)};c.onCancel=function(){d.resolve("cancel")};c.show(g)})}var b=this,d=new k;a.showDialog?e():c();return d.promise},__applyPrintSettings:function(a){function c(){b._getReportContainer().resizeRowHeightToShowCellsContent();var a=new k;setTimeout(a.resolve,500);return a.promise}function e(){return f(b._createHeaderFooterParams(a),function(a){b._headerFooterParams=a})}var b=this;this._commandId=a.commandId||this._commandId;var d=this._getReportContainer().toJson();this._pageSettingsRollBackFunc=
function(){b._player.updateTemplateJson(d);return b._player.refresh({rerenderContent:!0})};return f(!a.needAutoScale||c(),function(){b._pageSettings=a.pageSettings;var c=m.getPageBox(a.pageSettings);b._pageFitParams={w:c.w,h:c.h,hAlign:"center",vAlign:"top"};return e()})},_createHeaderFooterParams:function(a){var c=this._player.getCurrentAnalysisArea(),e=this._viewModel.getDocumentDefaultStyles(),b=this._player.getReportData().reportObject.dataVintageDescription;return{header:{show:a.addHeader,title:this._player.getReportTitle(),
subtitle:this._player.printConfig.subtitle,siteName:c.name,siteDesc:c.description,siteAddr:c.address,latitude:c.latitude,longitude:c.longitude,style:{headerStyle:e,titleStyle:this._viewModel.getTableDefaultStyles(null,"ReportTitle"),latLongStyle:this._viewModel.getTableDefaultStyles(null,"GreyText")}},dataSource:{show:b&&a.addDataSource,sourceText:"\x3cb\x3eSource: \x3c/b\x3e"+b,style:{dataSourceStyle:e}},footer:{show:a.addFooter,copyrightText:"\u00a9"+(new Date).getFullYear()+" Esri",formattedDate:n.getReportFooterDate(),
style:{footerStyle:e}},documentStyle:e}}})});