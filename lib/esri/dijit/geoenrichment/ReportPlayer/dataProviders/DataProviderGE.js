// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.22/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/dataProviders/DataProviderGE","dojo/_base/declare dojo/_base/lang dojo/promise/all dojo/when ./_CommandSupport ./_SerializationSupport ./supportClasses/CustomReportsManager ./supportClasses/TemplateJsonLoader ./supportClasses/ReportDataProcessor ./supportClasses/InfographicOptionsProvider ./supportClasses/AreasPreprocessor ./supportClasses/GEUtil ../core/themes/ThemeLibrary ../core/themes/ReportThemes ../core/supportClasses/templateJsonUtils/countryConfig esri/dijit/geoenrichment/utils/UrlUtil".split(" "),
function(k,l,m,n,p,q,d,r,e,t,u,v,w,h,x,y){return k([p,q],{analysisAreasLimit:-1,cacheTemplates:!0,printMapTaskUrl:null,_infographicOptionsProvider:null,constructor:function(){this._infographicOptionsProvider=new t},_getAttachmentsStore:function(c){return null},getCustomReports:function(c,b){return d.getCustomReports(c,b)},_currentContext:null,getReportData:function(c){var b=this;y.registerCORS(c.geoenrichmentUrl);var a=l.mixin({},c);a.fieldData={runReportTaskID:null,mainCalculatorName:null,metadata:{},
featureData:[],additionalCalcHash:{},errors:[]};this._currentContext=a;this._infographicOptionsProvider.setServerUrl(a);d.resetCache();return n(u.preprocessAreas(a,{analysisAreasLimit:b.analysisAreasLimit}),function(){return m({country:v.getCountry(a.geoenrichmentUrl,a.countryID),reportObject:d.getCustomReportByID(a),infographicOptions:b._infographicOptionsProvider.getInfographicOptions(a),attachmentsStore:b._getAttachmentsStore(a),templateJson:r.getTemplateJsonByID(a,b.cacheTemplates),runReportResult:e.runReportAndGetData(a)}).then(function(b){x.setCountry(b.country);
var c=b.reportObject,d=b.infographicOptions,f=b.attachmentsStore,g=b.templateJson;b=b.runReportResult;a.fieldData.mainCalculatorName=g.mainCalculatorName;e.applyRunReportAndGetDataResults(b,a);if(!c||!a.fieldData)return null;f&&e.populateReportDataFromAttachmentsStore(a,f);e.convertReportData(a);return{isClassic:!c.isGraphicReport,theme:g.theme||w.getReportThemeById(c.isGraphicReport?h.GRAPHIC:h.CLASSIC),reportType:c.type,reportTitle:c.title,templateJson:g,reportObject:c,fieldData:a.fieldData,analysisAreas:a.analysisAreas,
infographicOptions:d,attachmentsStore:f,config:{portalUrl:a.portalUrl,geoenrichmentUrl:a.geoenrichmentUrl,countryID:a.countryID,reportID:a.reportID}}})})},_getCurrentContext:function(){return this._currentContext},enrichFieldData:function(c,b){return e.enrichFieldData(c,b)}})});